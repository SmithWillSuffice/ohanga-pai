<!doctype html><html lang=en data-mode=dark><head prefix="og: http://ogp.me/ns#"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.101.0"><meta name=theme content="Color Your World -- gitlab.com/rmaguiar/hugo-theme-color-your-world"><title>Macromodels III --- IS-LM | Ōhanga Pai</title><meta name=author content="Bijou M. Smith"><meta name=robots content="index follow"><link rel=canonical href=https://smithwillsuffice.github.io/ohanga-pai/empirical/302_3_macromodels_islm_2/><meta property="og:site_name" content="Ōhanga Pai"><meta property="og:title" content="Macromodels III --- IS-LM"><meta property="og:url" content="https://smithwillsuffice.github.io/ohanga-pai/empirical/302_3_macromodels_islm_2/"><meta property="og:type" content="website"><meta name=twitter:dnt content="on"><meta name=theme-color content="#222"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="default"><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","url":"https://smithwillsuffice.github.io/ohanga-pai/","inLanguage":"en","name":"Ōhanga Pai","description":"Geon Theory Development","publisher":"Bijou M. Smith"}</script><link rel=stylesheet href=https://smithwillsuffice.github.io/ohanga-pai/css/main.min.d33233e3d0eb633ea1fbb9e17553fe7c8ff07875b91d8186e046a48480987c8e.css integrity="sha256-0zIz49DrYz6h+7nhdVP+fI/weHW5HYGG4EakhICYfI4=" crossorigin=anonymous><noscript><meta name=theme-color content="#1585d5"><link rel=stylesheet href=https://smithwillsuffice.github.io/ohanga-pai/css/noscript.min.d73d9c33b150230799106ddda48c6861047535f400bf9ad26ec48665cf803050.css integrity="sha256-1z2cM7FQIweZEG3dpIxoYQR1NfQAv5rSbsSGZc+AMFA=" crossorigin=anonymous></noscript><link rel=preload href=/ohanga-pai/fonts/OpenSans-Bold.ttf as=font crossorigin=anonymous><link rel=preload href=/ohanga-pai/fonts/OpenSans-Italic.ttf as=font crossorigin=anonymous><link rel=preload href=/ohanga-pai/fonts/OpenSans-Regular.ttf as=font crossorigin=anonymous><link rel=preload href=/ohanga-pai/fonts/Oswald-Bold.ttf as=font crossorigin=anonymous><link rel=preload href=/libs/katex@0.16.0/dist/fonts/KaTeX_Main-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/libs/katex@0.16.0/dist/fonts/KaTeX_Math-Italic.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/libs/katex@0.16.0/dist/fonts/KaTeX_Size2-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/libs/katex@0.16.0/dist/fonts/KaTeX_Size4-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script src=https://smithwillsuffice.github.io/ohanga-pai/js/main.eaf40cb85ba7b448519428d1b6c856258731f0bb71f875d541ba615cfca4bdbc.js integrity="sha256-6vQMuFuntEhRlCjRtshWJYcx8Ltx+HXVQbphXPykvbw=" crossorigin=anonymous></script></head><body><header><a href=/ohanga-pai><img src=https://smithwillsuffice.github.io/ohanga-pai/images/ohp_logo.svg alt="T4GU logo" style=display:flex;width:40px;height:34px;float:left;margin-bottom:-2.5px;margin-right:10px></a>
<a href=/ohanga-pai>Ōhanga Pai</a><nav aria-label="Main menu."><ul><li><a class=btn href=/ohanga-pai/>Home</a></li><li><a class=btn href=/ohanga-pai/questions/>Questions</a></li><li><a class=btn href=/ohanga-pai/empirical/>Empirical</a></li><li><a class=btn href=/ohanga-pai/blog/>Posts</a></li><li><a class=btn href=/ohanga-pai/contact/>Contact</a></li><li><a class=btn href=/ohanga-pai/donations/>Donate</a></li></ul></nav></header><div class=filler><main><article><header><h1>Macromodels III --- IS-LM</h1><p>Published on <time datetime=2024-12-06>2024-12-06</time></p></header><details class=toc open><summary class=outline-dashed>Contents</summary><nav id=TableOfContents><ul><li><a href=#data-preparation>Data Preparation</a><ul><li><a href=#interest-rates>Interest Rates</a></li><li><a href=#foreign-interest-rate-rast>Foreign Interest Rate ($r^\ast$)</a></li><li><a href=#national-income-y>National Income ($Y$)</a></li><li><a href=#net-government-expenditure-g-t>Net Government Expenditure $(G-T)$</a></li><li><a href=#autonomous-consumption-c_0>Autonomous Consumption ($C_0$)</a></li><li><a href=#consumption-sensitivity-c_y>Consumption Sensitivity ($c_y$)</a></li><li><a href=#investment-sensitivity-b>Investment Sensitivity ($b$)</a></li><li><a href=#autonomous-investment-i_0>Autonomous Investment ($I_0$)</a></li><li><a href=#money-supply-m>Money Supply ($M$)</a></li><li><a href=#liquidity-preference-parameter-ell>Liquidity Preference Parameter ($\ell$)</a></li></ul></li><li><a href=#data-processing>Data Processing</a><ul><li><a href=#autonomous-consumption-c_0-and-sensitivity-c_y>Autonomous Consumption ($C_0$ and sensitivity $c_y$)</a></li><li><a href=#investment-sensitivity-b-1>Investment Sensitivity ($b$)</a></li><li><a href=#autonomous-investment-i_0-1>Autonomous Investment ($I_0$)</a></li><li><a href=#liquidity-preference-parameter-ell-1>Liquidity Preference Parameter ($\ell$)</a></li></ul></li></ul></nav></details><p>Things get a bit messy now. If you inspect the code for our OpenEconomyISLMModel class in the python module, you will see we&rsquo;ve
added a time series analysis class <code>TimeSeriesISLMModel</code>
which will help us run some quasi-predictive tests against real world data.</p><p>Recall by &ldquo;quasi-predictive&rdquo; we run immediately into troubles since IS-LM is a
static equilibrium model. The idea of bastardizing Keynes&rsquo; General Theory is to
at least pay a little bit of homage to Keynes and try to make the ISLM model a
moving equilibria (whatever that means!) We will take it to mean there is a lag
somewhere between 1 and 12 months at which point the economy has &ldquo;figured out&rdquo;
what Income and interest rate &ldquo;should have been&rdquo;. We do not know the lag, so we
just run all the lags we want and see which fits best with the empirical data.</p><p>Seems reasonable? Yes, but then we need to go about fetching data, and
unfortunately the only economy that has decent data I am personally familiar
with fetching is the USA. That is just a bias, since I&rsquo;ve worked with the FRED
API before. If your country published accessible data then you can conduct a
similar analysis for your country. But honestly, why bother? We are aiming to
show that you should never use ISLM! Maybe ISLM will turn out to be a fit (as in
parameter adjusted) model for your country? Who knows!? But that would be fairly
accidental and bizarre.</p><h2 id=data-preparation><a class=anchor href=#data-preparation title='Anchor for: Data Preparation.'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Data Preparation</h2><p>No pain, no gain.</p><h3 id=interest-rates><a class=anchor href=#interest-rates title='Anchor for: Interest Rates.'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Interest Rates</h3><p>We can try either FRED Commercial Lending Rate series: <code>PRICELB</code>=Prime Loan
Rate, or <code>MPRIME</code>=Monthly Prime Lending Rate. I opted for &lsquo;MPRIME&rsquo;. You
definitely do not want the fedfunds rate or interbank rate, since that&rsquo;s merely
the floor rate or the &lsquo;policy rate&rsquo;. It determines the commercial rate, but we
do not want to bother modelling that function since we have the raw data.</p><h3 id=foreign-interest-rate-rast><a class=anchor href=#foreign-interest-rate-rast title='Anchor for: Foreign Interest Rate ($r^\ast$).'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Foreign Interest Rate ($r^\ast$)</h3><p>This is a tough one. Defining an effective foreign interest rate is complex.
Suggestions:</p><ul><li>G7 or G20 benchmark rates</li><li>Specific series:<ul><li><code>IRLTLT01USM156N</code>: US 10-Year Government Bond Yield (benchmark)</li><li>International equivalents:<ul><li>ECB Reference Rate</li><li>Bank of Japan Policy Rate</li><li>Bank of England Base Rate</li></ul></li></ul></li></ul><p>The series &lsquo;DGS10&rsquo; is daily data otherwise comparable to &lsquo;IRLTLT01USM156N&rsquo;,<br>but we only need monthly frequency, so I prefer the latter for the ISLM study.</p><p><strong>Another option</strong>: Create a trade-weighted composite rate based on: (1) Weights
of major trading partners; (2) Their respective government bond yields or central
bank rates. If you wanted to go to that effort, then the last step would be
putting your data into the proverbial calculator&mldr;</p><p>Here is how you might start with computing a Foreign Interest Rate Composite:</p><div class=highlight><pre aria-label="Box containing code sample." tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_weighted_foreign_rate</span><span class=p>(</span><span class=n>trade_weights</span><span class=p>,</span> <span class=n>countries</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Compute trade-weighted foreign interest rate
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>    - trade_weights: Dict of country trade weights
</span></span></span><span class=line><span class=cl><span class=s2>    - countries: Dict of country interest rate series
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>    Composite weighted foreign interest rate
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>composite_rate</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>weight</span> <span class=o>*</span> <span class=n>rate</span> 
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>country</span><span class=p>,</span> <span class=n>weight</span> <span class=ow>in</span> <span class=n>trade_weights</span><span class=o>.</span><span class=n>items</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>rate</span> <span class=ow>in</span> <span class=p>[</span><span class=n>countries</span><span class=p>[</span><span class=n>country</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>composite_rate</span>
</span></span></code></pre></div><p>If you want to avoid the worry, just eliminate the foreign sector from your
model! However, looking at the trade data the USA is still a big net importer,
so this should have a significant effect on the macroeconomic variables and
outputs we wish to model. If you want to write this up for a term paper for a
vegetative economics professor you could try this sort of little discussion to
justify using the US 10 year bond yield as a reasonable proxy for a
&lsquo;foreignInterestRate&rsquo; input.</p><p>Using the US 10-Year Treasury Yield as a proxy for $r^*$ is a reasonable
rough approach for the following reasons:</p><ul><li>Global Benchmark: The US 10-year bond yield is widely regarded as a global
benchmark for interest rates. It is influenced by international factors, such
as global demand for USD-denominated assets.</li><li>Foreign Holdings: Foreign investors hold significant amounts of US government
bonds. Changes in the 10-year yield can reflect shifts in global interest rate
expectations and investment preferences.</li></ul><p>Caveats:</p><ul><li>The US 10-year yield primarily reflects US government bond risk and liquidity
premia, so it may not fully capture foreign central bank or private market
conditions.</li><li>If your analysis heavily depends on exchange rate dynamics, the divergence
between US and global monetary policies might need finer calibration.</li></ul><p>If you want to be a bit lazy then, I think it is ok to use the <code>IRLTLT01USM156N</code>
as a proxy for $r^\ast$, since while it is not the foreign_interest_rate, is it
a reasonable proxy for $r^\ast$ given that investment in bonds is pretty much a
subtraction from investment in domestic production? Whether this is a reasonable
argument I am not sure, but you can take it up with your local ISLM guru. If it
means our whole analysis is unfair to ISLM well&mldr; suck on it!</p><h3 id=national-income-y><a class=anchor href=#national-income-y title='Anchor for: National Income ($Y$).'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>National Income ($Y$)</h3><p>I think we have to use nominal GDP since the other series will be in USD units, or millions of USD (&ldquo;usd_mil&rdquo;). The FRED series is <code>GDP</code>.</p><h3 id=net-government-expenditure-g-t><a class=anchor href=#net-government-expenditure-g-t title='Anchor for: Net Government Expenditure $(G-T)$.'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Net Government Expenditure $(G-T)$</h3><p>We can use <code>MTSDS133FMS</code>=Federal Surplus or Deficit.</p><h3 id=autonomous-consumption-c_0><a class=anchor href=#autonomous-consumption-c_0 title='Anchor for: Autonomous Consumption ($C_0$).'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Autonomous Consumption ($C_0$)</h3><p>One of these was recommend,</p><ul><li><code>PCE</code>=Personal Consumption Expenditures</li><li><code>DPCERL</code>=Personal Consumption Expenditures, Chained</li></ul><p>I went with &lsquo;OPCE&rsquo;, but I gathered &lsquo;DPCERL&rsquo; in my CSV file anyway, since it is
no bother to re-run our entire analysis with the alternates in case there is a
big difference.</p><h3 id=consumption-sensitivity-c_y><a class=anchor href=#consumption-sensitivity-c_y title='Anchor for: Consumption Sensitivity ($c_y$).'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Consumption Sensitivity ($c_y$)</h3><p>We derive this from change in consumption relative to income change
Compute from <code>PCE</code> and <code>PI</code> time series.</p><h3 id=investment-sensitivity-b><a class=anchor href=#investment-sensitivity-b title='Anchor for: Investment Sensitivity ($b$).'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Investment Sensitivity ($b$)</h3><p>We have to do a computation, using the series <code>GPDI</code>=Gross Private Domestic
Investment. Then we can compute sensitivity from investment changes relative to
interest rate.</p><h3 id=autonomous-investment-i_0><a class=anchor href=#autonomous-investment-i_0 title='Anchor for: Autonomous Investment ($I_0$).'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Autonomous Investment ($I_0$)</h3><p>We can use <code>GPDI</code>=Gross Private Domestic Investment, then look for the
baseline/trend component.</p><h3 id=money-supply-m><a class=anchor href=#money-supply-m title='Anchor for: Money Supply ($M$).'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Money Supply ($M$)</h3><p>I used the <code>M2SL</code> series, the M2 money stock.</p><h3 id=liquidity-preference-parameter-ell><a class=anchor href=#liquidity-preference-parameter-ell title='Anchor for: Liquidity Preference Parameter ($\ell$).'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Liquidity Preference Parameter ($\ell$)</h3><p>Two measures of velocity of money can be used,</p><ul><li><code>M2V</code>: Velocity of M2 Money Stock</li><li><code>M1V</code>: Velocity of M1 Money Stock</li></ul><p>Since I chose <code>M2SL</code> for supply (stock) I need to use <code>M2V</code> for velocity.</p><h2 id=data-processing><a class=anchor href=#data-processing title='Anchor for: Data Processing.'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Data Processing</h2><p>Do we have five parameters to estimate then? Let&rsquo;s go through these in detail.
The FRED API data pulls script I have is a bit lengthy, since I need to
interpolate some Quarterly series to Monthly, and down-sample some weekly series
to monthly. But you can get it from the github repo.</p><p>The FRED series I download are not all used, but I think are sufficient.
The dictionary I use is,</p><div class=highlight><pre aria-label="Box containing code sample." tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>series_dict</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;GDP&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Gross Domestic Product&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;flow&#39;</span><span class=p>,</span><span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;Q&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;bil&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;MPRIME&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Bank Prime Loan Rate&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;stock&#39;</span><span class=p>,</span><span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;%&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;FEDFUNDS&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Federal Funds Rate&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;stock&#39;</span><span class=p>,</span><span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;%&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;IRLTLT01USM156N&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;10-Year Treasury&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;stock&#39;</span><span class=p>,</span> <span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;%&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;PCE&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Personal Consumption Expenditures&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;flow&#39;</span><span class=p>,</span><span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;bil&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;PI&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Personal Income&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;flow&#39;</span><span class=p>,</span><span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;bil&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;DSPI&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Disposable Personal Income&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;flow&#39;</span><span class=p>,</span><span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;bil&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;GPDI&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Gross Private Domestic Investment&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;flow&#39;</span><span class=p>,</span> <span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;bil&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;MORTGAGE30US&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;30-Year Fixed Mortgage Rate&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;stock&#39;</span><span class=p>,</span><span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;W&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;%&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;DTWEXAFEGS&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Trade-Weighted Exchange Rate (Advanced Economies)&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;stock&#39;</span><span class=p>,</span><span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;None&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;DTWEXBGS&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Trade-Weighted Exchange Rate (Broad)&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;stock&#39;</span><span class=p>,</span><span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;None&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;M2V&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;M2 Money Velocity&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;stock&#39;</span><span class=p>,</span> <span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;Q&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;None&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;M2SL&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;M2 Money Stock&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;stock&#39;</span><span class=p>,</span> <span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;bil&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;M1V&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;M1 Money Velocity&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;stock&#39;</span><span class=p>,</span> <span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;Q&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;None&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;NETEXP&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Net Exports of Goods and Services&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;flow&#39;</span><span class=p>,</span> <span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;Q&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;bil&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;MTSDS133FMS&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Monthly Treasury Statement Deficit&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span><span class=s1>&#39;flow&#39;</span><span class=p>,</span> <span class=s1>&#39;freq&#39;</span><span class=p>:</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;unit&#39;</span><span class=p>:</span><span class=s1>&#39;mil&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>I did not automate fetching the &rsquo;type&rsquo;, &lsquo;freq&rsquo; and &lsquo;unit&rsquo; values, I wrote them
in by hand, so you should double chack them for yourself.</p><h3 id=autonomous-consumption-c_0-and-sensitivity-c_y><a class=anchor href=#autonomous-consumption-c_0-and-sensitivity-c_y title='Anchor for: Autonomous Consumption ($C_0$ and sensitivity $c_y$).'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Autonomous Consumption ($C_0$ and sensitivity $c_y$)</h3><p>To estimate $c_0$ and $c_y$, we&rsquo;ll need to separate the baseline consumption
that occurs regardless of income from the income-dependent consumption. We can
use PCE (Personal Consumption Expenditures) and PI (Personal Income) to estimate
the consumption function: $C = C_0 + c_y Y$.</p><p>Explicit code for this could be:</p><div class=highlight><pre aria-label="Box containing code sample." tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.linear_model</span> <span class=kn>import</span> <span class=n>LinearRegression</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>statsmodels.api</span> <span class=k>as</span> <span class=nn>sm</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>statsmodels.tsa.stattools</span> <span class=kn>import</span> <span class=n>adfuller</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>estimate_autonomous_consumption</span><span class=p>(</span><span class=n>pce</span><span class=p>,</span> <span class=n>pi</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Estimate autonomous consumption (C0) using PCE and Personal Income data
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Parameters:
</span></span></span><span class=line><span class=cl><span class=s2>    pce (pandas.Series): Personal Consumption Expenditures time series
</span></span></span><span class=line><span class=cl><span class=s2>    pi (pandas.Series): Personal Income time series
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>    dict: Dictionary containing C0, cy, R-squared, and other statistics
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Ensure data is properly aligned and clean</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;PCE&#39;</span><span class=p>:</span> <span class=n>pce</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;PI&#39;</span><span class=p>:</span> <span class=n>pi</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># Prepare data for regression</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;PI&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;PCE&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>values</span>
</span></span><span class=line><span class=cl>    <span class=c1># Run regression with statsmodels for detailed statistics</span>
</span></span><span class=line><span class=cl>    <span class=n>X_sm</span> <span class=o>=</span> <span class=n>sm</span><span class=o>.</span><span class=n>add_constant</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>model_sm</span> <span class=o>=</span> <span class=n>sm</span><span class=o>.</span><span class=n>OLS</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>X_sm</span><span class=p>)</span><span class=o>.</span><span class=n>fit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># Calculate basic regression with sklearn for prediction purposes</span>
</span></span><span class=line><span class=cl>    <span class=n>reg</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Compute statistics</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;C0&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>model_sm</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=mi>0</span><span class=p>]),</span>  <span class=c1># Autonomous consumption</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;cy&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>model_sm</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=mi>1</span><span class=p>]),</span>  <span class=c1># Marginal propensity to consume</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;r_squared&#39;</span><span class=p>:</span> <span class=n>model_sm</span><span class=o>.</span><span class=n>rsquared</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;adj_r_squared&#39;</span><span class=p>:</span> <span class=n>model_sm</span><span class=o>.</span><span class=n>rsquared_adj</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;p_values&#39;</span><span class=p>:</span> <span class=n>model_sm</span><span class=o>.</span><span class=n>pvalues</span><span class=o>.</span><span class=n>tolist</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;std_errors&#39;</span><span class=p>:</span> <span class=n>model_sm</span><span class=o>.</span><span class=n>bse</span><span class=o>.</span><span class=n>tolist</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;regression_summary&#39;</span><span class=p>:</span> <span class=n>model_sm</span><span class=o>.</span><span class=n>summary</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1># Add confidence intervals</span>
</span></span><span class=line><span class=cl>    <span class=n>conf_int</span> <span class=o>=</span> <span class=n>model_sm</span><span class=o>.</span><span class=n>conf_int</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;C0_conf_int&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>conf_int</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;cy_conf_int&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>conf_int</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Add diagnostic statistics</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;durbin_watson&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>sm</span><span class=o>.</span><span class=n>stats</span><span class=o>.</span><span class=n>stattools</span><span class=o>.</span><span class=n>durbin_watson</span><span class=p>(</span><span class=n>model_sm</span><span class=o>.</span><span class=n>resid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>results</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>analyze_consumption_stationarity</span><span class=p>(</span><span class=n>pce</span><span class=p>,</span> <span class=n>pi</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Analyze stationarity of consumption and income series
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Parameters:
</span></span></span><span class=line><span class=cl><span class=s2>    pce (pandas.Series): Personal Consumption Expenditures time series
</span></span></span><span class=line><span class=cl><span class=s2>    pi (pandas.Series): Personal Income time series
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>    dict: Dictionary containing stationarity test results
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=c1># Test PCE stationarity</span>
</span></span><span class=line><span class=cl>    <span class=n>pce_adf</span> <span class=o>=</span> <span class=n>adfuller</span><span class=p>(</span><span class=n>pce</span><span class=o>.</span><span class=n>dropna</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;pce_adf_stat&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pce_adf</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;pce_adf_pvalue&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pce_adf</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=c1># Test PI stationarity</span>
</span></span><span class=line><span class=cl>    <span class=n>pi_adf</span> <span class=o>=</span> <span class=n>adfuller</span><span class=p>(</span><span class=n>pi</span><span class=o>.</span><span class=n>dropna</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;pi_adf_stat&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pi_adf</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;pi_adf_pvalue&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pi_adf</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>results</span>
</span></span></code></pre></div><p>I add the $C_0$ and $c_y$ values as new columns to my <code>fred_df</code> dataframe
in memory, but I do not overwrite my fred csv file, I save the ISLM
parameter results to a separate CSV, <code>islm_series.csv</code>. If you want to
see my wrapper script just check the github repo.</p><p>I also save the stationarity analysis results to separate json files. But I have
not inspected them, since I already know ISLM is a bad model. Ive included the
stationarity analysis for you so you can write a term paper for your Turnip-head
(opr Potato-head, as the case may be) economics professor.</p><h3 id=investment-sensitivity-b-1><a class=anchor href=#investment-sensitivity-b-1 title='Anchor for: Investment Sensitivity ($b$).'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Investment Sensitivity ($b$)</h3><p>We can estimate the investment sensitivity parameter $b$ using GPDI and interest
rate data. We&rsquo;ll need to isolate how investment responds to interest rate
changes while controlling for other factors.</p><p>Explicit code for this could be:</p><div class=highlight><pre aria-label="Box containing code sample." tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># ... previous imports</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>statsmodels.tsa.filters.hp_filter</span> <span class=kn>import</span> <span class=n>hpfilter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>estimate_investment_sensitivity</span><span class=p>(</span><span class=n>gpdi</span><span class=p>,</span> <span class=n>interest_rate</span><span class=p>,</span> <span class=n>gdp</span><span class=p>,</span> <span class=n>control_for_output</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Estimate investment sensitivity (b) to interest rate changes.
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Parameters:
</span></span></span><span class=line><span class=cl><span class=s2>    gpdi (pandas.Series): Gross Private Domestic Investment
</span></span></span><span class=line><span class=cl><span class=s2>    interest_rate (pandas.Series): Interest rate series (e.g., MPRIME)
</span></span></span><span class=line><span class=cl><span class=s2>    gdp (pandas.Series): GDP series for controlling output effects
</span></span></span><span class=line><span class=cl><span class=s2>    control_for_output (bool): Whether to include GDP as control variable
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>    dict: Dictionary containing b, statistical measures, and diagnostic tests
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Create first differences to address potential non-stationarity</span>
</span></span><span class=line><span class=cl>    <span class=n>d_gpdi</span> <span class=o>=</span> <span class=n>gpdi</span><span class=o>.</span><span class=n>pct_change</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>d_interest</span> <span class=o>=</span> <span class=n>interest_rate</span><span class=o>.</span><span class=n>diff</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>d_gdp</span> <span class=o>=</span> <span class=n>gdp</span><span class=o>.</span><span class=n>pct_change</span><span class=p>()</span> <span class=k>if</span> <span class=n>control_for_output</span> <span class=k>else</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Align data and remove NAs</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Investment_Change&#39;</span><span class=p>:</span> <span class=n>d_gpdi</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Interest_Change&#39;</span><span class=p>:</span> <span class=n>d_interest</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;GDP_Change&#39;</span><span class=p>:</span> <span class=n>d_gdp</span> <span class=k>if</span> <span class=n>control_for_output</span> <span class=k>else</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Prepare regression variables</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>control_for_output</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>X</span> <span class=o>=</span> <span class=n>data</span><span class=p>[[</span><span class=s1>&#39;Interest_Change&#39;</span><span class=p>,</span> <span class=s1>&#39;GDP_Change&#39;</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>X</span> <span class=o>=</span> <span class=n>data</span><span class=p>[[</span><span class=s1>&#39;Interest_Change&#39;</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;Investment_Change&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=c1># Add constant and run regression</span>
</span></span><span class=line><span class=cl>    <span class=n>X_sm</span> <span class=o>=</span> <span class=n>sm</span><span class=o>.</span><span class=n>add_constant</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span> <span class=o>=</span> <span class=n>sm</span><span class=o>.</span><span class=n>OLS</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>X_sm</span><span class=p>)</span><span class=o>.</span><span class=n>fit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># Calculate investment sensitivity (b)</span>
</span></span><span class=line><span class=cl>    <span class=c1># Note: We take negative of coefficient since IS curve uses -b(r-r*)</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=o>-</span><span class=n>model</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=s1>&#39;Interest_Change&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;b_std_error&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>bse</span><span class=p>[</span><span class=s1>&#39;Interest_Change&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;b_p_value&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>pvalues</span><span class=p>[</span><span class=s1>&#39;Interest_Change&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;r_squared&#39;</span><span class=p>:</span> <span class=n>model</span><span class=o>.</span><span class=n>rsquared</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;adj_r_squared&#39;</span><span class=p>:</span> <span class=n>model</span><span class=o>.</span><span class=n>rsquared_adj</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;regression_summary&#39;</span><span class=p>:</span> <span class=n>model</span><span class=o>.</span><span class=n>summary</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1># Add confidence intervals</span>
</span></span><span class=line><span class=cl>    <span class=n>conf_int</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>conf_int</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;b_conf_int&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=o>-</span><span class=nb>float</span><span class=p>(</span><span class=n>conf_int</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;Interest_Change&#39;</span><span class=p>][</span><span class=mi>1</span><span class=p>]),</span> 
</span></span><span class=line><span class=cl>                            <span class=o>-</span><span class=nb>float</span><span class=p>(</span><span class=n>conf_int</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;Interest_Change&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>])]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Add diagnostic tests</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;durbin_watson&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>sm</span><span class=o>.</span><span class=n>stats</span><span class=o>.</span><span class=n>stattools</span><span class=o>.</span><span class=n>durbin_watson</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>resid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>results</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>analyze_investment_components</span><span class=p>(</span><span class=n>gpdi</span><span class=p>,</span> <span class=n>interest_rate</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Decompose investment series into trend and cyclical components
</span></span></span><span class=line><span class=cl><span class=s2>    to better understand interest rate sensitivity.
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Parameters:
</span></span></span><span class=line><span class=cl><span class=s2>    gpdi (pandas.Series): Gross Private Domestic Investment
</span></span></span><span class=line><span class=cl><span class=s2>    interest_rate (pandas.Series): Interest rate series
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>    dict: Dictionary containing cyclical analysis results
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Apply HP filter to decompose investment</span>
</span></span><span class=line><span class=cl>    <span class=n>cycle</span><span class=p>,</span> <span class=n>trend</span> <span class=o>=</span> <span class=n>hpfilter</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>gpdi</span><span class=p>),</span> <span class=n>lamb</span><span class=o>=</span><span class=mi>1600</span><span class=p>)</span>  <span class=c1># Using standard lambda for quarterly data</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Calculate correlation between cyclical component and interest rates</span>
</span></span><span class=line><span class=cl>    <span class=n>aligned_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;cycle&#39;</span><span class=p>:</span> <span class=n>cycle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;interest&#39;</span><span class=p>:</span> <span class=n>interest_rate</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>correlation</span> <span class=o>=</span> <span class=n>aligned_data</span><span class=p>[</span><span class=s1>&#39;cycle&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>corr</span><span class=p>(</span><span class=n>aligned_data</span><span class=p>[</span><span class=s1>&#39;interest&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;cycle&#39;</span><span class=p>:</span> <span class=n>cycle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;trend&#39;</span><span class=p>:</span> <span class=n>trend</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;interest_rate_correlation&#39;</span><span class=p>:</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></div><p>As before, you can organize your wrapper scripts to add the $b$
computations to your CSV files.</p><h3 id=autonomous-investment-i_0-1><a class=anchor href=#autonomous-investment-i_0-1 title='Anchor for: Autonomous Investment ($I_0$).'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Autonomous Investment ($I_0$)</h3><p>We can use GPDI=Gross Private Domestic Investment, then look for the
baseline/trend component. Taking raw GPDI as $I_0$ would be inaccurate because
GPDI includes both autonomous investment ($I_0$) and the interest-sensitive
component ($-b(r-r^\ast)$) that we already estimated. We need to decompose these
components.</p><p>Explicit code for this job:</p><div class=highlight><pre aria-label="Box containing code sample." tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># previous imports</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>statsmodels.tsa.seasonal</span> <span class=kn>import</span> <span class=n>seasonal_decompose</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>estimate_autonomous_investment</span><span class=p>(</span><span class=n>gpdi</span><span class=p>,</span> <span class=n>ir</span><span class=p>,</span> <span class=n>b_estimate</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Estimate autonomous investment (I0) by decomposing GPDI and removing
</span></span></span><span class=line><span class=cl><span class=s2>    interest rate sensitive components.
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Parameters:
</span></span></span><span class=line><span class=cl><span class=s2>    gpdi (pandas.Series): Gross Private Domestic Investment
</span></span></span><span class=line><span class=cl><span class=s2>    interest_rate (pandas.Series): Interest rate series
</span></span></span><span class=line><span class=cl><span class=s2>    b_estimate (float): Previously estimated interest rate sensitivity
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>    dict: Dictionary containing I0 estimates and decomposition components
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Align series and clean data</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;GPDI&#39;</span><span class=p>:</span> <span class=n>gpdi</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;interest_rate&#39;</span><span class=p>:</span> <span class=n>ir</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Method 1: HP Filter approach</span>
</span></span><span class=line><span class=cl>    <span class=n>cycle</span><span class=p>,</span> <span class=n>trend</span> <span class=o>=</span> <span class=n>hpfilter</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;GPDI&#39;</span><span class=p>]),</span> <span class=n>lamb</span><span class=o>=</span><span class=mi>14400</span><span class=p>)</span>  <span class=c1># Lambda for monthly data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Method 2: Remove interest rate component</span>
</span></span><span class=line><span class=cl>    <span class=n>interest_component</span> <span class=o>=</span> <span class=n>b_estimate</span> <span class=o>*</span> <span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;interest_rate&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;interest_rate&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>adjusted_investment</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;GPDI&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>interest_component</span>  <span class=c1># Add because IS curve has -b(r-r*)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Method 3: Seasonal decomposition</span>
</span></span><span class=line><span class=cl>    <span class=n>seasonal_result</span> <span class=o>=</span> <span class=n>seasonal_decompose</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;GPDI&#39;</span><span class=p>],</span> <span class=n>period</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>extrapolate_trend</span><span class=o>=</span><span class=s1>&#39;freq&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># Compute different I0 estimates</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;I0_hp&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>trend</span><span class=p>),</span>  <span class=c1># HP filter trend</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;I0_interest_adjusted&#39;</span><span class=p>:</span> <span class=n>adjusted_investment</span><span class=p>,</span>  <span class=c1># Interest-adjusted series</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;I0_seasonal_trend&#39;</span><span class=p>:</span> <span class=n>seasonal_result</span><span class=o>.</span><span class=n>trend</span><span class=p>,</span>  <span class=c1># Seasonal decomposition trend</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Store decomposition components</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;hp_cycle&#39;</span><span class=p>:</span> <span class=n>cycle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;hp_trend&#39;</span><span class=p>:</span> <span class=n>trend</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;seasonal_trend&#39;</span><span class=p>:</span> <span class=n>seasonal_result</span><span class=o>.</span><span class=n>trend</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;seasonal_seasonal&#39;</span><span class=p>:</span> <span class=n>seasonal_result</span><span class=o>.</span><span class=n>seasonal</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;seasonal_residual&#39;</span><span class=p>:</span> <span class=n>seasonal_result</span><span class=o>.</span><span class=n>resid</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Basic statistics</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;mean_I0_hp&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>trend</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;mean_I0_interest_adjusted&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>adjusted_investment</span><span class=o>.</span><span class=n>mean</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;mean_I0_seasonal&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>seasonal_result</span><span class=o>.</span><span class=n>trend</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1># Compute confidence bands using rolling statistics</span>
</span></span><span class=line><span class=cl>    <span class=n>window</span> <span class=o>=</span> <span class=mi>12</span>  <span class=c1># One year rolling window</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;I0_rolling_mean&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>adjusted_investment</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=n>window</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;I0_rolling_std&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>adjusted_investment</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=n>window</span><span class=p>)</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;I0_upper_band&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>results</span><span class=p>[</span><span class=s1>&#39;I0_rolling_mean&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>results</span><span class=p>[</span><span class=s1>&#39;I0_rolling_std&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;I0_lower_band&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>results</span><span class=p>[</span><span class=s1>&#39;I0_rolling_mean&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>results</span><span class=p>[</span><span class=s1>&#39;I0_rolling_std&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>results</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>analyze_I0_stability</span><span class=p>(</span><span class=n>gpdi</span><span class=p>,</span> <span class=n>interest_rate</span><span class=p>,</span> <span class=n>b_estimate</span><span class=p>,</span> <span class=n>window_sizes</span><span class=o>=</span><span class=p>[</span><span class=mi>6</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>24</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Analyze the stability of I0 estimates across different time windows
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Parameters:
</span></span></span><span class=line><span class=cl><span class=s2>    gpdi (pandas.Series): Gross Private Domestic Investment
</span></span></span><span class=line><span class=cl><span class=s2>    interest_rate (pandas.Series): Interest rate series
</span></span></span><span class=line><span class=cl><span class=s2>    b_estimate (float): Previously estimated interest rate sensitivity
</span></span></span><span class=line><span class=cl><span class=s2>    window_sizes (list): List of rolling window sizes to test
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>    dict: Dictionary containing stability analysis results
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>stability_results</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>window</span> <span class=ow>in</span> <span class=n>window_sizes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Calculate rolling estimates</span>
</span></span><span class=line><span class=cl>        <span class=n>rolling_data</span> <span class=o>=</span> <span class=n>estimate_autonomous_investment</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>gpdi</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=n>window</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>interest_rate</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=n>window</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>b_estimate</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>stability_results</span><span class=p>[</span><span class=sa>f</span><span class=s1>&#39;window_</span><span class=si>{</span><span class=n>window</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;mean&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>rolling_data</span><span class=p>[</span><span class=s1>&#39;mean_I0_hp&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;std&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>rolling_data</span><span class=p>[</span><span class=s1>&#39;I0_rolling_std&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;coefficient_of_variation&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>rolling_data</span><span class=p>[</span><span class=s1>&#39;I0_rolling_std&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>/</span> <span class=n>rolling_data</span><span class=p>[</span><span class=s1>&#39;mean_I0_hp&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>stability_results</span>
</span></span></code></pre></div><p>We are almost done, just one more to go.</p><h3 id=liquidity-preference-parameter-ell-1><a class=anchor href=#liquidity-preference-parameter-ell-1 title='Anchor for: Liquidity Preference Parameter ($\ell$).'><svg aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#hashtag"/></svg></a>Liquidity Preference Parameter ($\ell$)</h3><p>Two measures of velocity of money can be used, M2V: Velocity of M2 Money Stock
M1V: Velocity of M1 Money Stock. In the IS-LM model, the liquidity preference
parameter $\ell$ represents the sensitivity of money demand to the interest
rate. We&rsquo;ll need to do more than just look at velocity measures, since we need
to estimate how money demand responds to interest rate changes.</p><p>Explicit code:</p><div class=highlight><pre aria-label="Box containing code sample." tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># ... previous import</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>statsmodels.tsa.api</span> <span class=kn>import</span> <span class=n>VAR</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>estimate_liquidity_preference</span><span class=p>(</span><span class=n>m1v</span><span class=p>,</span> <span class=n>m2v</span><span class=p>,</span> <span class=n>interest_rate</span><span class=p>,</span> <span class=n>gdp</span><span class=p>,</span> <span class=n>money_supply</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Estimate liquidity preference parameter (lp) using money velocity and other monetary data
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Parameters:
</span></span></span><span class=line><span class=cl><span class=s2>    m1v (pandas.Series): Velocity of M1 Money Stock
</span></span></span><span class=line><span class=cl><span class=s2>    m2v (pandas.Series): Velocity of M2 Money Stock
</span></span></span><span class=line><span class=cl><span class=s2>    interest_rate (pandas.Series): Interest rate series
</span></span></span><span class=line><span class=cl><span class=s2>    gdp (pandas.Series): GDP series
</span></span></span><span class=line><span class=cl><span class=s2>    money_supply (pandas.Series): Money supply (M1 or M2)
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>    dict: Dictionary containing ℓ estimates and diagnostic statistics
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Calculate real money balances (M/P)</span>
</span></span><span class=line><span class=cl>    <span class=c1># Using GDP deflator implicit in velocity measure since V = PY/M</span>
</span></span><span class=line><span class=cl>    <span class=n>real_money</span> <span class=o>=</span> <span class=n>money_supply</span> <span class=o>/</span> <span class=p>(</span><span class=n>gdp</span> <span class=o>/</span> <span class=n>money_supply</span> <span class=o>*</span> <span class=n>m1v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Take logs for elasticity interpretation</span>
</span></span><span class=line><span class=cl>    <span class=n>log_real_money</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>real_money</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>log_gdp</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>gdp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Prepare data for regression</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;log_real_money&#39;</span><span class=p>:</span> <span class=n>log_real_money</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;log_gdp&#39;</span><span class=p>:</span> <span class=n>log_gdp</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;interest_rate&#39;</span><span class=p>:</span> <span class=n>interest_rate</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Estimate money demand equation: log(M/P) = log(Y) - ℓr</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>sm</span><span class=o>.</span><span class=n>add_constant</span><span class=p>(</span><span class=n>data</span><span class=p>[[</span><span class=s1>&#39;log_gdp&#39;</span><span class=p>,</span> <span class=s1>&#39;interest_rate&#39;</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;log_real_money&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span> <span class=o>=</span> <span class=n>sm</span><span class=o>.</span><span class=n>OLS</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>X</span><span class=p>)</span><span class=o>.</span><span class=n>fit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Extract ℓ (negative of interest rate coefficient)</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;lp&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=o>-</span><span class=n>model</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=s1>&#39;interest_rate&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;lp_std_error&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>bse</span><span class=p>[</span><span class=s1>&#39;interest_rate&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;lp_p_value&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>pvalues</span><span class=p>[</span><span class=s1>&#39;interest_rate&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;income_elasticity&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=s1>&#39;log_gdp&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;r_squared&#39;</span><span class=p>:</span> <span class=n>model</span><span class=o>.</span><span class=n>rsquared</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;regression_summary&#39;</span><span class=p>:</span> <span class=n>model</span><span class=o>.</span><span class=n>summary</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Add VAR analysis for dynamic relationships</span>
</span></span><span class=line><span class=cl>    <span class=n>var_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;real_money&#39;</span><span class=p>:</span> <span class=n>log_real_money</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;gdp&#39;</span><span class=p>:</span> <span class=n>log_gdp</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;interest&#39;</span><span class=p>:</span> <span class=n>interest_rate</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>var_model</span> <span class=o>=</span> <span class=n>VAR</span><span class=p>(</span><span class=n>var_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>var_results</span> <span class=o>=</span> <span class=n>var_model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>maxlags</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>ic</span><span class=o>=</span><span class=s1>&#39;aic&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Compute long-run elasticity from VAR</span>
</span></span><span class=line><span class=cl>    <span class=n>irf</span> <span class=o>=</span> <span class=n>var_results</span><span class=o>.</span><span class=n>irf</span><span class=p>(</span><span class=n>periods</span><span class=o>=</span><span class=mi>24</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>cumulative_response</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>cumsum</span><span class=p>(</span><span class=n>irf</span><span class=o>.</span><span class=n>irfs</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>  <span class=c1># Response of money to interest</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;var_long_run_lp&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=o>-</span><span class=n>cumulative_response</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Add alternative estimates using M2 velocity</span>
</span></span><span class=line><span class=cl>    <span class=c1># Similar calculation but using M2V</span>
</span></span><span class=line><span class=cl>    <span class=n>real_money_m2</span> <span class=o>=</span> <span class=n>money_supply</span> <span class=o>/</span> <span class=p>(</span><span class=n>gdp</span> <span class=o>/</span> <span class=n>money_supply</span> <span class=o>*</span> <span class=n>m2v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>log_real_money_m2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>real_money_m2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>data_m2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;log_real_money&#39;</span><span class=p>:</span> <span class=n>log_real_money_m2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;log_gdp&#39;</span><span class=p>:</span> <span class=n>log_gdp</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;interest_rate&#39;</span><span class=p>:</span> <span class=n>interest_rate</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>X_m2</span> <span class=o>=</span> <span class=n>sm</span><span class=o>.</span><span class=n>add_constant</span><span class=p>(</span><span class=n>data_m2</span><span class=p>[[</span><span class=s1>&#39;log_gdp&#39;</span><span class=p>,</span> <span class=s1>&#39;interest_rate&#39;</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>    <span class=n>y_m2</span> <span class=o>=</span> <span class=n>data_m2</span><span class=p>[</span><span class=s1>&#39;log_real_money&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>model_m2</span> <span class=o>=</span> <span class=n>sm</span><span class=o>.</span><span class=n>OLS</span><span class=p>(</span><span class=n>y_m2</span><span class=p>,</span> <span class=n>X_m2</span><span class=p>)</span><span class=o>.</span><span class=n>fit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;lp_m2&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=o>-</span><span class=n>model_m2</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=s1>&#39;interest_rate&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;lp_m2_std_error&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>model_m2</span><span class=o>.</span><span class=n>bse</span><span class=p>[</span><span class=s1>&#39;interest_rate&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>results</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>analyze_stability</span><span class=p>(</span><span class=n>m1v</span><span class=p>,</span> <span class=n>m2v</span><span class=p>,</span> <span class=n>interest_rate</span><span class=p>,</span> <span class=n>gdp</span><span class=p>,</span> <span class=n>money_supply</span><span class=p>,</span> <span class=n>window_sizes</span><span class=o>=</span><span class=p>[</span><span class=mi>12</span><span class=p>,</span> <span class=mi>24</span><span class=p>,</span> <span class=mi>36</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Analyze stability of ℓ estimates across different time windows
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Parameters:
</span></span></span><span class=line><span class=cl><span class=s2>    [same as above]
</span></span></span><span class=line><span class=cl><span class=s2>    window_sizes: List of rolling window sizes for stability analysis
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>    dict: Dictionary containing stability analysis results
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>stability_results</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>window</span> <span class=ow>in</span> <span class=n>window_sizes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>rolling_ell</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=n>m1v</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=n>window</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>m1v</span><span class=p>)</span> <span class=o>-</span> <span class=n>window</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>slice_results</span> <span class=o>=</span> <span class=n>estimate_liquidity_preference</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>m1v</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=n>window</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>m2v</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=n>window</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>interest_rate</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=n>window</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>gdp</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=n>window</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>money_supply</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=n>window</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>rolling_ell</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>slice_results</span><span class=p>[</span><span class=s1>&#39;lp&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=n>stability_results</span><span class=p>[</span><span class=sa>f</span><span class=s1>&#39;window_</span><span class=si>{</span><span class=n>window</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;mean_lp&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>rolling_ell</span><span class=o>.</span><span class=n>mean</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;std_lp&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>rolling_ell</span><span class=o>.</span><span class=n>std</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;cv_lp&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>rolling_ell</span><span class=o>.</span><span class=n>std</span><span class=p>()</span> <span class=o>/</span> <span class=n>rolling_ell</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>stability_results</span>
</span></span></code></pre></div><p>I think that&rsquo;s it for data collection. This chapter has not given you the full
code, but it is a good exercise to organize a script for this yourself.</p><p>The next thing is to run some scenarios and test the model.</p><table style="border-collapse:collapse;border=0"><col span=1 style=width:25%><col span=1 style=width:10%><col span=1 style=width:25%><tr style="border:1px solid color:#0f0f0f"><td style="border:1px solid color:#0f0f0f"><a href=../302_3_macromodels_islm_2>Previous chapter</a></td><td style="border:1px solid color:#0f0f0f;text-align:center"><a href=./>Back to</a></td><td style="border:1px solid color:#0f0f0f;text-align:right"><a href=../303_4_macromodels_islm_3>Next chapter</a></td></tr><tr style="border:1px solid color:#0f0f0f"><td style="border:1px solid color:#0f0f0f"><a href=../302_3_macromodels_islm_2>MM—II, Intro</a></td><td style="border:1px solid color:#0f0f0f;text-align:center"><a href=./>TOC</a></td><td style="border:1px solid color:#0f0f0f;text-align:right"><a href=../303_4_macromodels_islm_3>MM—IV, ISLM part-3</a></td></tr></table></article></main></div><footer><div class=req-js><button class=outline-dashed title="Change to light/dark mode."><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><use xlink:href="/ohanga-pai/img/bundle.min.fc89b321aa39dfb355170fc007ce5b94.svg#adjust"/></svg></button><input class=outline-dashed type=color list=presets value=#1585d5 title="Change accent color." aria-label="Change accent color."><datalist id=presets><option value=#1f676b><option value=#1585d5><option value=#225670><option value=#dd587c><option value=#902b37><option value=#f3a530><option value=#754e85><option value=#7fc121><option value=#a8314a><option value=#ff7433><option value=#3e6728><option value=#c063bd><option value=#805080><option value=#9d629d><option value=#a064a0><option value=#7daa50><option value=#284531><option value=#285790><option value=#F5A83D><option value=#88aa33><option value=#015660><option value=#bf274e><option value=#bf4242><option value=#51b37c></datalist></div><noscript><p class=noscript>Unable to execute JavaScript. Some features were disabled.</p></noscript></footer><link rel=stylesheet href=https://smithwillsuffice.github.io/ohanga-pai/libs/katex@0.16.0/dist/katex.min.6950e59dbd8dfddd111390d85888bb5f9dc2e9c334da7ac1c3bacc92a695610d.css integrity="sha256-aVDlnb2N/d0RE5DYWIi7X53C6cM02nrBw7rMkqaVYQ0=" crossorigin=anonymous><script defer src=https://smithwillsuffice.github.io/ohanga-pai/libs/katex@0.16.0/dist/katex.min.4268ce940bc6faa510d7b638acc3f08a63501d9504dd3155bfc48d6838ade320.js integrity="sha256-QmjOlAvG+qUQ17Y4rMPwimNQHZUE3TFVv8SNaDit4yA=" crossorigin=anonymous></script>
<script defer src=https://smithwillsuffice.github.io/ohanga-pai/js/katex-custom-render.min.cdeaf561a454e015b169c385f95c72d57d41f906a9bc4100636b18e1e4c15da3.js integrity="sha256-zer1YaRU4BWxacOF+Vxy1X1B+QapvEEAY2sY4eTBXaM=" crossorigin=anonymous></script></body></html>